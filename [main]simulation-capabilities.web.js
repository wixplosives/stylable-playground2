(self.webpackChunk_wixc3_stylable_playground_feature=self.webpackChunk_wixc3_stylable_playground_feature||[]).push([[1330],{20329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.universalCtrl=t.ACTIONS=t.MOUSE=t.KEYBOARD=void 0;const s=r(91570);t.KEYBOARD={UNIDENTIFIED:"Unidentified",ESCAPE:"Escape",MINUS:"Minus",DASH:"Minus",EQUALS:"Equal",BACK_SPACE:"Backspace",TAB:"Tab",ENTER:"Enter",RETURN:"Enter",SHIFT:"Shift",CONTROL:"Control",ALT:"Alt",PAUSE:"Pause",CAPS_LOCK:"CapsLock",SPACE:"Space",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",PRINTSCREEN:"PrintScreen",INSERT:"Insert",DELETE:"Delete",0:"Digit0",1:"Digit1",2:"Digit2",3:"Digit3",4:"Digit4",5:"Digit5",6:"Digit6",7:"Digit7",8:"Digit8",9:"Digit9",A:"KeyA",B:"KeyB",C:"KeyC",D:"KeyD",E:"KeyE",F:"KeyF",G:"KeyG",H:"KeyH",I:"KeyI",J:"KeyJ",K:"KeyK",L:"KeyL",M:"KeyM",N:"KeyN",O:"KeyO",P:"KeyP",Q:"KeyQ",R:"KeyR",S:"KeyS",T:"KeyT",U:"KeyU",V:"KeyV",W:"KeyW",X:"KeyX",Y:"KeyY",Z:"KeyZ",META:"Meta",OS_LEFT:"OSLeft",CONTEXT_MENU:"ContextMenu",NUMPAD0:"Numpad0",NUMPAD1:"Numpad1",NUMPAD2:"Numpad2",NUMPAD3:"Numpad3",NUMPAD4:"Numpad4",NUMPAD5:"Numpad5",NUMPAD6:"Numpad6",NUMPAD7:"Numpad7",NUMPAD8:"Numpad8",NUMPAD9:"Numpad9",NUMPAD_MULTIPLY:"NumpadMultiply",NUMPAD_ADD:"NumpadAdd",NUMPAD_SUBTRACT:"NumpadSubtract",NUMPAD_DECIMAL:"NumpadDecimal",NUMPAD_DIVIDE:"NumpadDivide",NUMPAD_ENTER:"NumpadEnter",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",F13:"F13",F14:"F14",F15:"F15",F16:"F16",F17:"F17",F18:"F18",F19:"F19",F20:"F20",F21:"F21",F22:"F22",F23:"F23",F24:"F24",NUM_LOCK:"NumLock",SCROLL_LOCK:"ScrollLock",SEMICOLON:"Semicolon",COMMA:"Comma",PERIOD:"Period",SLASH:"Slash",BACK_QUOTE:"Backquote",OPEN_BRACKET:"BracketLeft",BACK_SLASH:"Backslash",CLOSE_BRACKET:"BracketRight",QUOTE:"Quote",UNIVERSAL_CONTROL:s.isMac?"Meta":"Control"},t.MOUSE={WHEEL_VERTICAL:"wheelVertical",WHEEL_HORIZONTAL:"wheelHorizontal"},t.ACTIONS={DELETE:"delete"},t.universalCtrl=s.isMac?t.KEYBOARD.META:t.KEYBOARD.CONTROL},90925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5163);s.__exportStar(r(20329),t),s.__exportStar(r(81588),t),s.__exportStar(r(31287),t)},81588:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScopesService=void 0,t.ScopesService=class{constructor(){this.isolatedScope=!1}removeScope(e){this.scope===e&&(this.scope=void 0,this.isolatedScope=!1)}setScope(e,t={isIsolated:!1}){const{isIsolated:r}=t;this.scope=e,this.isolatedScope=null!=r&&r}getScope(){return this.scope}getIsolatedScope(){return this.isolatedScope}}},31287:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},62202:(e,t,r)=>{e.exports=r(90925)},11320:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.demoAstParsers=void 0;const s=r(26709),o=r(9240);t.demoAstParsers=[...o.commonSimpleAstParsers,s.demoPlugin].map((e=>e.nodeKind))},4601:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5163);s.__exportStar(r(73676),t),s.__exportStar(r(11320),t),s.__exportStar(r(59114),t)},73676:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simulationAstParsers=void 0;const s=r(26709),o=r(9240);t.simulationAstParsers=[...o.commonSimpleAstParsers,s.demoPlugin].map((e=>e.nodeKind))},59114:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},51321:(e,t,r)=>{e.exports=r(4601)},78432:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useResources=t.useResource=t.useResourceApplyChange=t.useResourceValidity=t.useResourceValue=t.useResourceState=t.useApplyChange=t.useValidity=t.useValue=t.useResourceSubscriber=t.useHoldResource=t.useResourceInstance=void 0;const s=r(87363),o=r(93849),i=r(60814),n=r(69202);function a({resource:e,defaultValue:t,enabled:r=!0}){const i=(0,n.useForceUpdate)(),a=(0,s.useRef)(!1),u=(0,n.useLatest)(r),c=(0,s.useCallback)((()=>{u.current&&!a.current&&i()}),[u,i]);return(0,s.useEffect)((()=>(e&&e.subscribe(c),(null==e?void 0:e.ready)&&e.ready.then(c).catch(o.reportError),()=>{null==e||e.unsubscribe(c)})),[c,e]),(0,s.useEffect)((()=>()=>{a.current=!0}),[]),function(e,t){return e&&e.isReady()&&e.isValid()?e.getLatest():t}(e,t)}function u({resource:e,enabled:t=!0}){const[r,o]=(0,s.useState)(),i=(0,s.useCallback)((()=>{if(t){const t=e&&e.isReady()?e.isValid():void 0;o(t)}}),[e,t]);return(0,s.useEffect)((()=>{var r;if(!e)return void(t&&o(void 0));let s=!1;const n=()=>{s||i()};return e.subscribe(n),n(),null===(r=e.ready)||void 0===r||r.then(n).catch(n),()=>{s=!0,e.unsubscribe(n)}}),[e,i,t]),r}function c(e){return(0,s.useCallback)((t=>{null==e||e.applyChange(t)}),[e])}function l(e){return!!e.ids}t.useResourceInstance=({resourceManager:e,resourceId:t,enabled:r=!0})=>{const o=(0,s.useMemo)((()=>({})),[]),i=(0,s.useRef)({resourceManager:e,resourceId:t}),n=(0,s.useMemo)((()=>{if(void 0===t)return;const{current:s}=i;return function(e,t,r){return e||t.resourceId!==r.resourceId||t.resourceManager!==r.resourceManager}(r,s,{resourceManager:e,resourceId:t})?e.get(t,o):s.resourceInstance}),[t,r,e,o]);return i.current={resourceManager:e,resourceId:t,resourceInstance:n},(0,s.useEffect)((()=>()=>null==n?void 0:n.release(o)),[n,o]),n},t.useHoldResource=e=>{(0,s.useEffect)((()=>{const t={};return e.use(t),()=>{e.release(t)}}),[e])},t.useResourceSubscriber=(e,t)=>{(0,s.useEffect)((()=>{const r=()=>t(e.getLatest());return null==e||e.subscribe(r),()=>null==e?void 0:e.unsubscribe(r)}),[t,e])},t.useValue=a,t.useValidity=u,t.useApplyChange=c,t.useResourceState=function({resource:e,enabled:t,defaultValue:r}){const o=a({resource:e,enabled:t,defaultValue:(null==e?void 0:e.getLatest())||r}),n=c(e),u=(0,s.useCallback)((e=>n((0,i.fullChange)(e))),[n]);return[o,u,e]},t.useResourceValue=function({resourceManager:e,resourceId:r,defaultValue:s,enabled:o=!0}){return a({resource:(0,t.useResourceInstance)({resourceManager:e,resourceId:r,enabled:o}),defaultValue:s,enabled:o})},t.useResourceValidity=function({resourceManager:e,resourceId:r,enabled:s=!0}){return u({resource:(0,t.useResourceInstance)({resourceManager:e,resourceId:r,enabled:s}),enabled:s})},t.useResourceApplyChange=function({resourceManager:e,resourceId:r}){return c((0,t.useResourceInstance)({resourceManager:e,resourceId:r}))},t.useResource=function(e,t){const[r,o]=(0,s.useState)(t);return(0,s.useEffect)((()=>{var r;let s=!1;if(!e)return;const i=()=>{s||(e.isReady()&&e.isValid()?o(e.getLatest()):o(t))};return e.subscribe(i),i(),null===(r=e.ready)||void 0===r||r.then(i).catch(i),()=>{s=!0,e.unsubscribe(i)}}),[e,t]),e&&e.isReady()?e.getLatest():r};const d=new WeakMap,m=e=>{const t=d.get(e);if(t)for(const r of Object.keys(t))for(const s of Object.keys(t[r]))t[r][s].resource.isReady()&&t[r][s].resource.release(e)},p=(e,t,r,s,o)=>{const i=t.getType();t.isReady()||o.push(t.ready),e[i]||(e[i]={}),e[i][t.getSerializedId()]={resource:t,field:r,isInnerRecord:s}},g={valid:!1,message:"Loading"},S=(e,t)=>{for(const r of Object.keys(e))if(t[r])for(const s of t[r])if(e[r][s])return!0;return!1};t.useResources=function(e,t=!0){const r=(e=>JSON.stringify(e,((e,t)=>t instanceof i.ResourceManager?t.getTypeName():t)))(e),[n]=(0,s.useState)({cleanupRequested:!1,enabled:t,hasChanges:!1,used:new Set});n.enabled=t;const[a,u]=(0,s.useState)(0),c=Object.keys(e),b=c.length?e[c[0]].resourceManager.getBatcher():void 0,f=d.get(n)||{},h=(0,s.useCallback)((e=>{if(!n.enabled)return;const t=S(f,e.changed),r=S(f,e.changedStatus);(t||r)&&u(Math.random())}),[f,n]);return d.has(n)||(d.set(n,f),b.subscribe(h)),(0,s.useMemo)((()=>{const t=[];n.enabled&&(b.batchAll((()=>{const r=new Set;for(const[s,o]of Object.entries(e))if(l(o))for(const e of o.ids){const i=o.resourceManager.get(e,n);r.add(i),p(f,i,s,!0,t)}else if(o.id){const e=o.resourceManager.get(o.id,n);r.add(e),p(f,e,s,!0,t)}for(const e of Object.values(f))for(const[t,s]of Object.entries(e))r.has(s.resource)||(s.resource.isReady()?(s.resource.release(n),delete e[t]):s.resource.ready.then((()=>{n.used.has(s.resource)||(s.resource.release(n),delete e[t])})).catch(o.reportError));n.used=r})),t.length&&n.enabled&&Promise.all(t).then((e=>{n.cleanupRequested?m(n):u(Math.random())})).catch((e=>{throw e})))}),[r,n,b,f]),(0,s.useEffect)((()=>()=>{m(n),b.unsubscribe(h),n.cleanupRequested=!0}),[n]),(0,s.useMemo)((()=>{return Object.keys(e).reduce(((r,s)=>{const o=e[s];if(l(o))r[s]={getResource:e=>t(s,e),getValue(e){const r=t(s,e);return r&&r.isValid()?r.getLatest():o.defaultValue},getStatus(e){const r=t(s,e);return r&&r.isReady()?r.getStatus():g}};else{const e=t(s,o.id);r[s]={value:e&&e.isValid()?e.getLatest():o.defaultValue,status:e?e.getStatus():g,resource:e}}return r}),{});function t(t,r){const s=e[t],o=l(s)?r:s.id;if(!o||!f[s.resourceManager.getTypeName()])return;const n=f[s.resourceManager.getTypeName()][(0,i.serializeId)(o)];return n&&n.resource&&n.resource.isReady()?n.resource:void 0}}),[a,t,r])}},40386:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5163);s.__exportStar(r(78432),t),s.__exportStar(r(23496),t)},23496:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createJSONResource=void 0;const s=r(60814);t.createJSONResource=function(e){return new s.JSONResource("data",{provider:{provide:()=>({value:e})},resourceType:"state-resource",batcher:new s.Batcher})}},27941:(e,t,r)=>{e.exports=r(40386)},49659:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5163),o=r(5689),i=r(60814),n=s.__importDefault(r(16894)),a=r(28659),u=r(94698),c=r(26709);n.default.setup(o.mainEnv,(({demoListManager:e,demoErrorManager:t,simulationProcessingService:r,environmentPropsManager:s},{simpleAST:{simpleASTPlugin:o,simpleASTMain:n,idGenerator:l}})=>{o.register(c.demoPlugin);const d=e.consume({manipulator:u.demoListManipulator}),m=t.consume({}),p=s.consume({manipulator:i.fullChangeManipulator});return{simulationService:new a.SimulationService(d,r,p,n,l),demoErrorManagerMain:m,demoListManagerMain:d,environmentPropsManagerMain:p}}))},26393:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSimulationName=t.useSimWindowSize=t.useSimulationInfo=t.useSimulationList=t.useComponentSims=t.useSimManager=void 0;const s=r(87363),o=r(27941),i=r(3092),n=r(50210);t.useSimManager=(e,t)=>{const[r,o]=(0,s.useState)();return(0,s.useEffect)((()=>{if(o(void 0),!t)return;let r,s=!1;const i=()=>{s=!0,r&&r.dispose()};return(async()=>{r=await e.getSimulation(t),s?i():o(r)})().catch((()=>{})),i}),[t]),r},t.useComponentSims=(e,r,o=!0)=>{const n=(0,t.useSimulationList)(e,o);return(0,s.useMemo)((()=>{if(void 0!==n)return(0,i.getComponentSimulations)(n,r)}),[n,r])},t.useSimulationList=(e,t=!0)=>{const r=(0,o.useResourceValue)({resourceManager:e.getSimulationListManager(),resourceId:"",enabled:t});return(0,s.useMemo)((()=>null==r?void 0:r.sort(((e,t)=>(0,i.compareDemoNames)(e.name,t.name)))),[r])},t.useSimulationInfo=(e,t,r=!0)=>{const i=(0,o.useResourceValue)({resourceManager:e.getSimulationListManager(),resourceId:"",enabled:r});return(0,s.useMemo)((()=>null==i?void 0:i.find((e=>e.boardPath===t))),[i,t])},t.useSimWindowSize=e=>{const[t,r]=(0,s.useState)(n.defaultEnvironmentProperties.windowWidth),[o,i]=(0,s.useState)(n.defaultEnvironmentProperties.windowHeight);return(0,s.useEffect)((()=>{if(!e)return;const t=e=>{var t,s;r(null!==(t=e.windowWidth)&&void 0!==t?t:n.defaultEnvironmentProperties.windowWidth),i(null!==(s=e.windowHeight)&&void 0!==s?s:n.defaultEnvironmentProperties.windowHeight)};return e.subscribeToEnvProps(t),()=>e.unsubscribeFromEnvProps(t)}),[e]),{width:t,height:o}},t.useSimulationName=(e,r)=>{const o=(0,t.useSimManager)(e,r),[i,n]=(0,s.useState)(null==o?void 0:o.getSimulationName());return(0,s.useEffect)((()=>{const e=e=>n(e);return null==o||o.subscribeToSimulationName(e),()=>null==o?void 0:o.unsubscribeFromSimulationName(e)}),[o]),i}},28659:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5163);s.__exportStar(r(26393),t),s.__exportStar(r(24219),t),s.__exportStar(r(66593),t)},24219:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPropErrorFromDiagnostics=void 0,t.getPropErrorFromDiagnostics=e=>{let t,r;if(e)for(const s of e)s.messageText.includes(" is not assignable to type ")?(t="type-mismatch",r=s.messageText):t||(t="other",r=s.messageText);return{semanticErrorType:t,semanticErrorMessage:r}}},66593:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5163);s.__exportStar(r(40864),t),s.__exportStar(r(17839),t)},40864:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulationManager=void 0;const s=r(3092),o=r(91570),i=r(9240),n=r(51321);t.SimulationManager=class{constructor(e,t,r,s){this.boardPath=e,this.envPropsResource=t,this.astResource=r,this.idGenerator=s,this.envPropsSubscriber=(0,o.setupSubscribers)(),this.simulationNameSubscriber=(0,o.setupSubscribers)(),this.notifyEnvProps=()=>this.envPropsSubscriber.internals.notify(this.envPropsResource.getLatest()),this.notifySimulationNameChange=()=>{const e=this.getSimulationName();e!==this.simulationName&&(this.simulationNameSubscriber.internals.notify(e),this.simulationName=e)},this.simulationName=this.getSimulationName(),this.envPropsResource.subscribe(this.notifyEnvProps),this.astResource.subscribe(this.notifySimulationNameChange)}static async create(e,t,r,s){return new this(e,await t.getReady(e,this),await r.getReady({filePath:e,parsers:n.simulationAstParsers},this),s)}dispose(){this.envPropsResource.release(this),this.envPropsResource.unsubscribe(this.notifyEnvProps),this.astResource.release(this.notifySimulationNameChange)}getSimulationName(){const e=(0,s.getDemoNode)(this.astResource);return e?e.name.value:"Simulation"}getSimulationPath(){return this.boardPath}subscribeToEnvProps(e){this.envPropsSubscriber.subscribe(e),e(this.envPropsResource.getLatest())}unsubscribeFromEnvProps(e){this.envPropsSubscriber.unsubscribe(e)}subscribeToSimulationName(e){this.simulationNameSubscriber.subscribe(e),e(this.getSimulationName())}unsubscribeFromSimulationName(e){this.simulationNameSubscriber.unsubscribe(e)}getEnvironmentProps(){return this.envPropsResource.getLatest()}patchEnvProps(e){const t=(0,s.getDemoNode)(this.astResource);if(!t)throw new Error("Can't locate demo node");const r=()=>this.idGenerator.generateId(this.getSimulationPath()),o=t.environmentProps||this.createEnvironmentProps(this.astResource,t,r);this.generateObjectPropsModifications(e,o,r).forEach((({modKind:e,modArgs:t,targetNode:r})=>{this.astResource.applyModification(null!=r?r:o,e,t)}))}generateObjectPropsModifications(e,t,r){const s=[];for(const o in e){const n=(0,i.getSimpleObjectProp)(t.properties,o),a=this.generatePropModification(o,e[o],r,n);s.push(...a)}return s}createEnvironmentProps(e,t,r){const o=(0,i.createStringNode)({astNodeId:r(),value:"environmentProps"}),n=i.objectPlugin.createBlank(r);e.applyModification(t,"addEnvironmentProps",{name:o,value:n});const a=(0,s.getDemoNode)(e);if(!(null==a?void 0:a.environmentProps))throw new Error("Failed to create environment props");return a.environmentProps}generatePropModification(e,t,r,s){if("number"==typeof t)return s?[{modKind:"setProperty",modArgs:{childId:s.astNodeId,value:(0,i.createNumberNode)({astNodeId:r(),value:t})}}]:[{modKind:"addProperty",modArgs:{name:(0,i.createStringNode)({astNodeId:r(),value:e}),value:(0,i.createNumberNode)({astNodeId:r(),value:t}),propertyId:r()}}];if("object"==typeof t){const o=[];for(const e in t){const n=s&&(0,i.isObjectNode)(s.initializer)?(0,i.getSimpleObjectProp)(s.initializer.properties,e):void 0,a=this.generatePropModification(e,t[e],r,n);o.push(...a)}if(s)return o.forEach((e=>{e.targetNode||(e.targetNode=s.initializer)})),o;{let t=i.objectPlugin.createBlank(r);return o.forEach((({modKind:e,modArgs:r})=>{"addProperty"===e&&(t=i.objectPlugin.modifiers.addProperty(t,r))})),[{modKind:"addProperty",modArgs:{name:(0,i.createStringNode)({astNodeId:r(),value:e}),value:t,propertyId:r()}}]}}return[]}}},17839:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulationService=void 0;const s=r(40864);t.SimulationService=class{constructor(e,t,r,s,o){this.simulationListManager=e,this.simulationProcessingService=t,this.envPropsManager=r,this.astManager=s,this.idGenerator=o}async createSimulation(e){await Promise.all([this.waitForSimulationListUpdate(),this.simulationProcessingService.createDemo(e)])}async deleteSimulation(e){return await this.simulationProcessingService.deleteSimulation(e)}getSimulation(e){return s.SimulationManager.create(e,this.envPropsManager,this.astManager,this.idGenerator)}async copySimulation(e,t,r){await Promise.all([this.waitForSimulationListUpdate(),this.simulationProcessingService.copySimulation(e,t,r)])}async renameSimulation(e,t){await Promise.all([this.waitForSimulationListUpdate(),this.simulationProcessingService.renameDemo(e,t)])}getSimulationListManager(){return this.simulationListManager}waitForSimulationListUpdate(){return new Promise((e=>{const t=this.simulationListManager.get("");t.isValid()&&t.subscribeOnce(e)}))}}}}]);