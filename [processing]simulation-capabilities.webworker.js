(self.webpackChunk_wixc3_stylable_playground_feature=self.webpackChunk_wixc3_stylable_playground_feature||[]).push([[21],{11320:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.demoAstParsers=void 0;const o=i(26709),n=i(9240);t.demoAstParsers=[...n.commonSimpleAstParsers,o.demoPlugin].map((e=>e.nodeKind))},4601:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163);o.__exportStar(i(73676),t),o.__exportStar(i(11320),t),o.__exportStar(i(59114),t)},73676:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simulationAstParsers=void 0;const o=i(26709),n=i(9240);t.simulationAstParsers=[...n.commonSimpleAstParsers,o.demoPlugin].map((e=>e.nodeKind))},59114:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},51321:(e,t,i)=>{e.exports=i(4601)},53818:(e,t)=>{"use strict";var i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PULL_FAILED=t.PUSH_FAILED=t.GIT_TRACKING_BRANCH_RESOURCE_ID=t.GIT_SYNC_REPO_RESOURCE_ID=t.GIT_MERGER_STATE_RESOURCE_ID=t.GIT_BRANCH_LIST_RESOURCE_ID=t.GIT_REPO_STATUS_RESOURCE_ID=t.GIT_HEAD_RESOURCE_ID=t.BackgroundFetchBlocker=t.GitFileModificationStatus=void 0,(o=t.GitFileModificationStatus||(t.GitFileModificationStatus={})).Modified="Modified",o.Renamed="Renamed",o.Deleted="Deleted",o.Added="Added",o.Conflicted="Conflicted",(i=t.BackgroundFetchBlocker||(t.BackgroundFetchBlocker={})).HTTPSAuthError="HTTPS_AUTH_ERROR",i.SSHAuthError="SSH_AUTH_ERROR",i.NotAGitRepo="NOT_A_GIT_REPO",t.GIT_HEAD_RESOURCE_ID="GIT_HEAD_RESOURCE_ID",t.GIT_REPO_STATUS_RESOURCE_ID="GIT_REPO_STATUS_RESOURCE_ID",t.GIT_BRANCH_LIST_RESOURCE_ID="GIT_BRANCH_LIST_RESOURCE_ID",t.GIT_MERGER_STATE_RESOURCE_ID="GIT_MERGER_STATE_RESOURCE_ID",t.GIT_SYNC_REPO_RESOURCE_ID="GIT_SYNC_REPO_RESOURCE_ID",t.GIT_TRACKING_BRANCH_RESOURCE_ID="GIT_TRACKING_BRANCH_RESOURCE_ID",t.PUSH_FAILED="PUSH_FAILED",t.PULL_FAILED="PULL_FAILED"},49136:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GitSyncRepoResource=t.gitSyncRepoDefaultValue=void 0;const o=i(60814);t.gitSyncRepoDefaultValue={isFetching:!1,isPulling:!1,isPushing:!1,fetchFailed:!1};class n extends o.Resource{startFetching(){this.applyChange((0,o.fullChange)({...this.getLatest(),isFetching:!0,fetchFailed:!1}))}doneFetching(){this.applyChange((0,o.fullChange)({...this.getLatest(),isFetching:!1,lastFetch:(new Date).getTime(),fetchFailed:!1}))}fetchingFailed(){this.applyChange((0,o.fullChange)({...this.getLatest(),isFetching:!1,fetchFailed:!0}))}startPulling(){this.applyChange((0,o.fullChange)({...this.getLatest(),isPulling:!0}))}donePulling(){this.applyChange((0,o.fullChange)({...this.getLatest(),lastFetch:(new Date).getTime(),isPulling:!1}))}startPushing(){this.applyChange((0,o.fullChange)({...this.getLatest(),isPushing:!0}))}donePushing(){this.applyChange((0,o.fullChange)({...this.getLatest(),lastFetch:(new Date).getTime(),isPushing:!1}))}}t.GitSyncRepoResource=n},99559:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163);o.__exportStar(i(53818),t),o.__exportStar(i(49136),t)},94256:(e,t,i)=>{e.exports=i(99559)},98180:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.directoryManipulator=t.directoryReducer=t.DirectoryChangeKind=void 0,function(e){e.FULL="full",e.ADD="add",e.REMOVE="remove"}(i=t.DirectoryChangeKind||(t.DirectoryChangeKind={})),t.directoryReducer=(e,t)=>{switch(t.kind){case i.FULL:return{value:t.value,invertingChanges:[{kind:i.FULL,value:e}]};case i.ADD:return{value:[...e,t.node],invertingChanges:[{kind:i.FULL,value:e}]};case i.REMOVE:return{value:e.filter((e=>e.name!==t.name)),invertingChanges:[{kind:i.FULL,value:e}]};default:return{value:e,invertingChanges:[{kind:i.FULL,value:e}]}}},t.directoryManipulator={reducer:t.directoryReducer}},34232:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFileNamingConvention=void 0;const o=i(91570);t.defaultFileNamingConvention=o.NamingConvention.KebabCase},61276:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileScannerComputeHandler=t.getDirectoryEntities=t.traverseFs=void 0;const o=i(93849),n=i(98180);t.traverseFs=function e({directoryPath:t,fs:i,filterFile:n=o.returnsTrue,filterDirectory:s=o.returnsTrue,directories:r=[],files:a=[]}){const{readdirSync:d}=i;r.push({path:t,name:i.basename(t)});for(const o of d(t,{withFileTypes:!0})){const d=o.name,l=i.join(t,d);o.isDirectory()&&s(l,d)?e({directoryPath:l,fs:i,filterFile:n,filterDirectory:s,directories:r,files:a}):o.isFile()&&n(l,d)&&a.push({path:l,name:d})}return{directories:r,files:a}},t.getDirectoryEntities=function({directoryPath:e,fs:t}){const{readdirSync:i}=t,o={directories:[],files:[]};for(const n of i(e,{withFileTypes:!0})){const i=n.name,s=t.join(e,i);n.isDirectory()?o.directories.push({path:s,name:i}):n.isFile()&&o.files.push({path:s,name:i})}return o},t.FileScannerComputeHandler=class{constructor(e,t,i,o,n){this.controller=e,this.manipulator=t,this.fs=i,this.pathPredicate=o,this.directoryManager=n}compute(e){let t=this.controller.getEmptyValue();const{changes:i,dependencies:o}=this.addDirectory(e,t);for(const e of i)t=this.manipulator.reducer(t,e).value;return{value:t,dependencies:o,status:{valid:!0}}}recompute(e,t,i,o){const n=e.getLatest(),s=[];let r=new Set(o);for(const e of i){if(!e.isValid())continue;const i=e.getType(),{changes:o,dependencies:a}=this.getDirectoryRelatedUpdates(e,t[i][e.getSerializedId()],n,r);s.push(...o),r=a}const a=Array.from(o).filter((e=>!e.isValid()));return{dependencies:new Set([...r].filter((e=>!a.includes(e)))),changes:s,status:{valid:!0}}}addDirectory(e,t){const i=new Set,{files:o,directoryResources:n}=this.addDirRecurse(e),s=[],r=this.controller.onFilesAdded(t,o.map((({path:e})=>e)));return n.forEach((e=>i.add(e))),s.push(...r.changes),{changes:s,dependencies:i}}addDirRecurse(e,t=[],i=[],o=[]){const n=this.directoryManager.get(e);o.push(n);const s=n.getLatest();for(const n of s){const s={name:n.name,path:this.fs.join(e,n.name)};this.pathPredicate(s.path)&&(n.stats.isDirectory?(t.push(s),this.addDirRecurse(s.path,t,i,o)):n.stats.isFile&&this.controller.predicate(s.path)&&i.push(s))}return{files:i,directories:t,directoryResources:o}}getDirectoryRelatedUpdates(e,t,i,o){if(t.isDisposed())return{changes:[],dependencies:o};const s=[],r=new Set(o),a=e.getChangesFromVersion(t),d=e.getId();return a.forEach((e=>{if(e.kind===n.DirectoryChangeKind.ADD){const t=this.fs.join(d,e.node.name);if(e.node.stats.isDirectory){if(this.pathPredicate(t)){const{changes:e,dependencies:o}=this.addDirectory(t,i);for(const e of o)r.add(e);s.push(...e)}}else if(this.pathPredicate(t)&&this.controller.predicate(t)){const{changes:e}=this.controller.onFilesAdded(i,[t]);s.push(...e)}}else if(e.kind===n.DirectoryChangeKind.REMOVE){const t=this.fs.join(d,e.name);s.push(...this.controller.onRemoved(i,t))}})),{changes:s,dependencies:r}}}},33506:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removePrefixPath=t.createPathPredicate=t.directoryDeepChildren=t.getPathsOfFilePath=t.getTreeNodePath=void 0;const o=i(71876),n=i(73654),s=i(91570);function r(e,t){return e.split(t).filter((e=>!!e))}function a(){return!0}t.getTreeNodePath=r,t.getPathsOfFilePath=function(e,t){var i;const o=e?r(e,t):[],n=[];for(let e=0;e<o.length;e++)n.push((null!==(i=n[e-1])&&void 0!==i?i:"")+t+o[e]);return n},t.directoryDeepChildren=async function*e(t,i,o=a,n=i){for(const s of await t.promises.readdir(i,{withFileTypes:!0})){const r=s.name,a=t.join(i,r),d=t.relative(n,a);if(s.isFile()){const e={type:"file",path:a,name:r,relativePath:d};o(e)&&(yield e)}else if(s.isDirectory()){const i={type:"directory",path:a,name:r,relativePath:d};o(i)&&(yield i,yield*e(t,a,o,n))}}},t.createPathPredicate=function(e,t,i){const n=i.map((e=>(0,o.makeRe)(e)));return i=>{const o=e.relative(t,i);return!n.some((e=>e.test(o)))}},t.removePrefixPath=(e,t)=>e?(0,s.replaceWinSlashes)(n.win32.relative(e,t)):(0,s.replaceWinSlashes)(t)},18012:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163);o.__exportStar(i(78204),t),o.__exportStar(i(98180),t),o.__exportStar(i(33506),t),o.__exportStar(i(98073),t),o.__exportStar(i(61276),t),o.__exportStar(i(34232),t)},98073:(e,t)=>{"use strict";var i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NodeType=t.FsEventType=void 0,(o=t.FsEventType||(t.FsEventType={}))[o.CREATE=0]="CREATE",o[o.LOAD=1]="LOAD",o[o.UPDATE=2]="UPDATE",o[o.DELETE=3]="DELETE",(i=t.NodeType||(t.NodeType={}))[i.directory=0]="directory",i[i.file=1]="file",i[i.virtual=2]="virtual",i[i.none=3]="none"},69144:(e,t,i)=>{e.exports=i(18012)},14667:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163),n=i(60814),s=i(2206),r=o.__importDefault(i(16894)),a=i(71600),d=i(3092),l=i(65432),c=i(44401),u=i(26709);r.default.setup(s.processingEnv,(({demoListManager:e,demoErrorManager:t,environmentPropsManager:i,boardsPathConfig:o},{simpleAST:{simpleAST:r,simpleASTPlugin:p,sourceIdResource:g,simpleASTPluginRepo:f,languageASTPlugin:h},gitRevision:{gitFileStatusResourceManager:m},project:{fs:v,projectService:_,pluggableProjectConfig:P,fileNamingConventionConfig:C},typescript:{editorConfig:S},fileAssets:{assets:R}})=>{const y=P.get(s.PROJECT_CONFIG_NAME),E=(0,a.getBoardsPathFromConfig)(_,y,o),D=(0,a.getFileNamingConventionFromConfig)(y,C);h.register(a.jsxFileConvertor),h.register(a.jsxOwnerConvertor),h.register(a.jsxOwnerFunctionConvertor),p.register(u.demoPlugin);const F=t.provide({handler:{provide:()=>({value:{errors:{}}})}}),A=new c.DemoListComputeHandler(R,r,f,v,m,(()=>_.getProjectPath()));return{demoErrorManager:F,demoListManager:e.provide({manipulator:d.demoListManipulator,dependencies:[R,m,r],handler:A}),simulationProcessingService:new a.SimulationProcessingService({editorConfig:S,projectService:_,simpleAstManager:r,sourceIdResourceManager:g,simpleASTPluginRepo:f,boardsPath:E,fileNamingConvention:D}),environmentPropsManager:i.provide({manipulator:n.fullChangeManipulator,dependencies:[r],handler:new l.EnvPropsComputeHandler(r,f)})}}))},71600:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=i(5163);o.__exportStar(i(77689),t),o.__exportStar(i(61375),t),o.__exportStar(i(24297),t),o.__exportStar(i(42682),t),o.__exportStar(i(95919),t),o.__exportStar(i(42146),t)},42682:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsxFileConvertor=void 0;const o=i(5163).__importDefault(i(60270)),n=i(8260),s=i(42146),r=i(64200),a=i(95919),d=i(91788),l=i(40977),c=i(73654),u=i(91570);function p(e,t,i){return i?s.jsxOwnerFunctionConvertor.isApplicable(e,t):o.default.isFunctionLike(e)&&0===(0,r.getScopeJsxRoots)(e,t).length}const g=(e,t,i)=>{const o=(0,r.flattenParents)(e),s=o.find((e=>p(e,t,i)));if(s)return s;const a=[...o].reverse(),d=a.find((e=>p(e,t,i)));if(d)return d;if(!i)return;return a.find((e=>(0,n.isNamedDeclaration)(e)))||o[1]};function f(e){return(0,u.isRelativeImportPath)(e.text)||(0,u.isRelativeModulePath)(e.text)}t.jsxFileConvertor={language:"typescript",isApplicable:e=>o.default.isSourceFile(e),convert(e,t){const i=new Set,l=new Set,c=new Set,u=new Set;return(0,n.visitAstAndBreak)(t.lang.getChildren,e,(e=>{if(d.demoConvertor.isApplicable(e,t)){c.add(e);const i=e,o=(0,d.getPropInitializerFromDemoNode)(i,"Board"),n=t.idService.nodesToIds.get(o);u.add(n)}if((0,r.isJsxNode)(e)){const o=g(e,t,!0);if(o){const e=t.idService.nodesToIds.get(o);return u.has(e)||i.add(o),!1}}if(o.default.isReturnStatement(e)&&e.expression){const i=g(e.expression,t,!1);i&&l.add(i)}return!0})),{kind:"jsx-file",astNodeId:t.getNodeId(e),owners:[...i].flatMap((e=>p(e,t,!0)?s.jsxOwnerFunctionConvertor.convert(e,t):a.jsxOwnerConvertor.convert(e,t))),demos:[...c].flatMap((e=>d.demoConvertor.convert(e,t))),nonJsxOwners:[...l].flatMap((e=>p(e,t,!1)?s.jsxOwnerFunctionConvertor.convert(e,t):a.jsxOwnerConvertor.convert(e,t)))}},kind:"jsx-file",modifications:{moveNode:l.moveNode,updateModuleSpecifiersForPathChange(e,t,{sourceFilePath:i,targetFilePath:s}){const r=c.win32.dirname(i),a=c.win32.dirname(s);return r===a?[]:e.statements.filter(o.default.isImportDeclaration).sort(((e,t)=>t.getEnd()-e.getEnd())).map((e=>e.moduleSpecifier)).filter(o.default.isStringLiteral).filter(f).flatMap((e=>{const i=e.text,o=c.posix.resolve(r,i),a=(0,u.rebaseRelativeModulePath)(s,o);return n.stringConvertor.modifications.setValue(e,t,{value:a})}))}},defaultConfig:{}}},42146:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsxOwnerFunctionConvertor=void 0;const o=i(5163).__importDefault(i(60270)),n=i(56284),s=i(8260),r=i(64200),a=i(9240),d=e=>o.default.isFunctionLike(e)?e:d(e.parent),l=(e,t)=>t.parent?t.parent===e?t:l(e,t.parent):t,c=(e,t)=>t.parent&&t!==e?o.default.isIfStatement(t)?[t.expression,...c(e,t.parent)]:o.default.isCaseClause(t)?[t,...c(e,t.parent)]:c(e,t.parent):[];t.jsxOwnerFunctionConvertor={language:"typescript",isApplicable:(e,t)=>o.default.isFunctionLike(e)&&(0,r.getScopeJsxRoots)(e,t).length>0,convert(e,t){const i=new Set,a=new Set;o.default.isArrowFunction(e)&&!o.default.isBlock(e.body)?a.add(e.body):(0,s.visitAstAndBreak)(t.lang.getChildren,e,(t=>{if(t===e)return!0;if(o.default.isReturnStatement(t)&&d(t)===e){if(t.expression)return a.add(t.expression),!1}else if((0,r.isJsxNode)(t)||o.default.isVariableDeclaration(t))return i.add(t),!1;return!0}));const u=(null==e?void 0:e.body)||e,p=[...i].reduce(((e,t)=>(e.add(l(u,t)),e)),new Set);return(0,n.createJsxOwnerFunction)({astNodeId:t.getNodeId(e),names:(0,r.getNames)(e,t),nonReturnRoots:[...p].map((e=>t.convert(e))).flat(),returnRoots:[...a].map((e=>({conditions:c(u,e).map((e=>({astNodeId:t.getNodeId(e),code:e.getText()}))),returnValue:t.convertLeaf(e)}))).flat()})},kind:"jsx-function",modifications:{addChild(e,t,i){if(!(0,a.isAddInsteadModArgs)(i))throw new Error("jsx-owner-function only supports add-instead");const o=t.getNodeByID(i.insteadOfChildId);if(!o)throw new Error(`can't find child with id: ${i.insteadOfChildId}`);return[{from:o.getFullStart(),to:o.getEnd(),newContent:t.generate(i.newChild),removedIds:[i.insteadOfChildId]}]}},defaultConfig:{}}},95919:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsxOwnerConvertor=t.getOwnerRoots=void 0;const o=i(5163).__importDefault(i(60270)),n=i(8260),s=i(34249),r=i(64200);t.getOwnerRoots=(e,t)=>{const i=[];(0,n.visitAstAndBreak)(t.lang.getChildren,e,(t=>t===e||!(0,r.isJsxNode)(t)||(i.push(t),!1)));const s=new Set;for(const t of i){const i=(0,r.flattenParents)(t,e).find((e=>o.default.isConditionalExpression(e)));i?s.add(i):s.add(t)}return s},t.jsxOwnerConvertor={language:"typescript",isApplicable:()=>!1,convert(e,i){const o=(0,t.getOwnerRoots)(e,i);return(0,s.createJsxOwner)({astNodeId:i.getNodeId(e),names:(0,r.getNames)(e,i),roots:[...o].map((e=>i.convertLeaf(e)))})},kind:"jsx-owner",modifications:{},defaultConfig:{}}},64200:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScopeJsxRoots=t.getNames=t.flattenParents=t.isJsxNode=void 0;const o=i(5163),n=i(8260),s=o.__importDefault(i(60270));function r(e){return s.default.isJsxElement(e)||s.default.isJsxSelfClosingElement(e)||s.default.isJsxFragment(e)}t.isJsxNode=r,t.flattenParents=(e,i,o=[])=>e.parent&&(o.unshift(e),e.parent!==i)?(0,t.flattenParents)(e.parent,i,o):o,t.getNames=(e,i)=>[...(0,t.flattenParents)(e.parent),e].filter((e=>(0,n.isNamedDeclaration)(e)&&e.name)).map((e=>({astNodeId:i.getNodeId(e),name:e.name.getText()}))),t.getScopeJsxRoots=(e,t)=>{const i=[];return(0,n.visitAstAndBreak)(t.lang.getChildren,e,(t=>r(t)?(i.push(t),!1):e===t||!s.default.isFunctionLike(t))),i}},44401:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DemoListComputeHandler=void 0;const o=i(5163),n=i(26315),s=i(3092),r=o.__importDefault(i(78435)),a=i(9240),d=o.__importDefault(i(72321)),l=i(26427),c=i(94256),u=i(91570),p=i(26709),g=i(8260);t.DemoListComputeHandler=class{constructor(e,t,i,o,s,r){this.fileAssetsResourceManager=e,this.simpleAstManager=t,this.simpleASTPluginRepo=i,this.fs=o,this.versionControlResourceManager=s,this.getProjectPath=r,this.resolveRequest=(0,n.createRequestResolver)({fs:this.fs,extensions:u.resolveExtensions})}compute(){d.default.mark(l.COMPUTE_DEMO_LIST_MARK);const e=new Set,t=[],i=this.fileAssetsResourceManager.get(this.getProjectPath());e.add(i);const o=i.getFilesWithTag(p.DEMO_FILE_TAG);for(const i of o){const o=this.getSimpleAstResource(i),n=this.findDemo(o);if(e.add(o),!(0,p.isDemoNode)(n))continue;const s=this.getDemoInfoFromAstNode(n,i);null!==s&&(t.push(s),e.add(this.versionControlResourceManager.get(i)))}return{value:t.sort(s.sortDemos),dependencies:e,status:{valid:!0}}}getDemoInfoFromAstNode(e,t){try{const i=this.versionControlResourceManager.get(t),o=this.isFileModified(i),n=(0,g.findComponents)(e.demo,this.simpleASTPluginRepo.getPlugins()),r=new Set,a=[];for(const e of n){const i=this.resolveComponentPath(t,e);if(!i)continue;const o=(0,s.getComponentRef)(i,e.targetExport);r.has(o)||(a.push({filePath:i,exportName:e.targetExport,defaultImportIdentifier:e.symbolName}),r.add(o))}return{boardPath:t,name:e.name.value,isModified:o,components:a}}catch(e){}return null}resolveComponentPath(e,t){return this.resolveRequest(this.fs.dirname(e),t.targetFile).resolvedFile||void 0}findDemo(e){const t=e.getLatest();return(0,a.findNode)(t,this.simpleASTPluginRepo.getPlugins(),p.isDemoNode)}recompute(e,t,i,o){d.default.mark(l.RECOMPUTE_DEMO_LIST_MARK);let n=new Set(o);const a=[];if(!e.isValid())return{changes:a,dependencies:n,status:e.getStatus()};const c=Array.from(o).filter((e=>!e.isValid()&&e.getType()===this.simpleAstManager.getTypeName()));let u=e.getLatest();for(const e of i){const i=e.getType(),o=[];if(i===this.fileAssetsResourceManager.getTypeName()){const{changes:s,dependencies:r}=this.getLocationsRelatedUpdates(e,t[i][e.getSerializedId()],n);o.push(...s),n=r}else if(i===this.simpleAstManager.getTypeName()){const t=e,i=t.getId().filePath,n=this.findDemo(t);if((0,p.isDemoNode)(n)){const e=this.getDemoInfoFromAstNode(n,i),t=[(0,s.createUpdateFileDemosChange)(i,e?[e]:[])];let a=u;for(const e of t)a=(0,s.demoListReducer)(u,e).value;u=u.sort(s.sortDemosByFile),a=a.sort(s.sortDemosByFile),(0,r.default)(u,a)||o.push(...t)}}else if(i===this.versionControlResourceManager.getTypeName()){const t=e.getId(),i=u.find((e=>e.boardPath===t));if(i){const e=this.versionControlResourceManager.get(i.boardPath);o.push({kind:s.DemoListChangeKind.UPDATE_MODIFIED,boardPath:i.boardPath,isModified:this.isFileModified(e)})}}a.push(...o)}for(const e of i)e.getType()===this.simpleAstManager.getTypeName()&&c.includes(e)&&"Deleted"===e.getInvalidationMessage()&&a.push((0,s.createUpdateFileDemosChange)(e.getId().filePath,[]));return{changes:a,dependencies:n,status:e.getStatus()}}getLocationsRelatedUpdates(e,t,i){if(t.isDisposed())return{changes:[],dependencies:i};const o=[],n=new Set(i),r=e.getProjection(t),a=e.getFilesWithTag(p.DEMO_FILE_TAG,r),d=e.getFilesWithTag(p.DEMO_FILE_TAG),l=d.filter((e=>!a.includes(e))),c=a.filter((e=>!d.includes(e)));for(const e of l){const t=this.getSimpleAstResource(e),i=this.findDemo(t);if((0,p.isDemoNode)(i)){n.add(t),n.add(this.versionControlResourceManager.get(e)),t.isValid()||o.push((0,s.createUpdateFileDemosChange)(e,[]));try{const t=this.getDemoInfoFromAstNode(i,e);null!==t&&o.push((0,s.createUpdateFileDemosChange)(e,[t]))}catch(e){}}}for(const e of c){const t=[...n].filter((t=>{this.simpleAstManager.isResourceOfType(t)&&t.getId().filePath===e||this.versionControlResourceManager.isResourceOfType(t)&&t.getId()}));for(const e of t)n.delete(e);o.push((0,s.createUpdateFileDemosChange)(e,[]))}return{changes:o,dependencies:n}}getSimpleAstResource(e){return this.simpleAstManager.get({filePath:e,parsers:[...this.simpleASTPluginRepo.getPlugins().values(),p.demoPlugin].map((e=>e.nodeKind))})}isFileModified(e){const t=e.getLatest();return!!t&&t.modificationStatus===c.GitFileModificationStatus.Modified}}},65432:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnvPropsComputeHandler=void 0;const o=i(9240),n=i(60814),s=i(26709);t.EnvPropsComputeHandler=class{constructor(e,t){this.simpleAstManager=e,this.simpleASTPluginRepo=t}compute(e){const t=this.simpleAstManager.get({filePath:e,parsers:[...this.simpleASTPluginRepo.getPlugins().values(),s.demoPlugin].map((e=>e.nodeKind))}),i=new Set([t]),o=this.getEnvironmentPropsNode(t);return o?{value:r(o),dependencies:i}:{value:{},dependencies:i}}getEnvironmentPropsNode(e){const t=(0,o.findNode)(e.getLatest(),this.simpleASTPluginRepo.getPlugins(),s.isDemoNode);return null==t?void 0:t.environmentProps}recompute(e){const{value:t,dependencies:i}=this.compute(e.getId());return{changes:t?[(0,n.fullChange)(t)]:[],dependencies:i,status:{valid:!0}}}};const r=e=>{const t={};return(0,o.isObjectNode)(e)&&e.properties.forEach((e=>{if((0,o.isPropertyNode)(e)&&(0,o.isStringNode)(e.name)){const i=e.name.value;((0,o.isNumberNode)(e.initializer)||(0,o.isStringNode)(e.initializer)||(0,o.isBooleanNode)(e.initializer))&&(t[i]=e.initializer.value),(0,o.isObjectNode)(e.initializer)&&(t[i]=r(e.initializer))}})),t}},77689:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(5163).__exportStar(i(65432),t)},24297:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(5163).__exportStar(i(34652),t)},34652:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimulationProcessingService=t.getEmptyDemoFileContent=t.getDemoContent=void 0;const o=i(91570),n=i(9240),s=i(8260),r=i(51321),a=i(3092),d=i(26709);t.getDemoContent=(e,t,i,r)=>{const a=(0,n.getComponentName)(t,i),d="default"===i?a:`{ ${a} }`,l=t.replace(/\\/g,"/"),c=r?'"':"'";return`import React from 'react';\nimport { createBoard } from ${c}@wixc3/react-board${c};\nimport ${d} from ${c}${(0,o.getImportPath)(l)}${c};\n\nexport default createBoard({\n    name: ${c}${(r?s.escapeDblQuote:s.escapeSingleQuote)(e)}${c},\n    Board: () => <${a} />\n});\n`},t.getEmptyDemoFileContent=(e,t)=>{const i=t?'"':"'";return`import React from 'react';\nimport { createBoard } from ${i}@wixc3/react-board${i};\n\nexport default createBoard({\n    name: ${i}${(t?s.escapeDblQuote:s.escapeSingleQuote)(e)}${i},\n    Board: () => <div></div>\n});\n`},t.SimulationProcessingService=class{constructor(e){this.options=e,this.envBacther=e.simpleAstManager.batcher,this.fs=e.projectService.fs}createDemo({filePath:e,name:i,componentRef:n}){var s,r;const{projectService:d,editorConfig:l}=this.options;if(d.fs.fileExistsSync(e))throw new Error(`Cannot create Demo at path: ${e}, a file with the same name already exists there.`);const c=null!==(r=null===(s=null==l?void 0:l.formatSettings)||void 0===s?void 0:s.doubleQuotes)&&void 0!==r&&r;let u;if(void 0===n)u=(0,t.getEmptyDemoFileContent)(i,c);else{const{filePath:s,exportName:r}=(0,a.getComponentRefObject)(n);let l=d.fs.relative(d.fs.dirname(e),s);(0,o.isRelativeModulePath)(l)||(l=`./${l}`),u=(0,t.getDemoContent)(i,l,r,c)}d.writeFile(e,u)}async copySimulation(e,t,i){if(this.options.projectService.fs.fileExistsSync(t))throw new Error(`Cannot create simulation at path: ${t}, a file with the same name already exists there.`);this.options.projectService.copy(e,t);const s=this.options.simpleAstManager.get({filePath:t,parsers:[...this.options.simpleASTPluginRepo.getPlugins().values()].map((e=>e.nodeKind))});await s.waitForValid(),await(0,o.newMacrotask)(),this.envBacther.batchAll((()=>{const o=s.getLatest(),r=(0,n.findNode)(o,this.options.simpleASTPluginRepo.getPlugins(),d.isDemoNode),a=[];if(a.push(s.getModification(o,"updateModuleSpecifiersForPathChange",{sourceFilePath:e,targetFilePath:t})),(0,d.isDemoNode)(r)&&i&&r.name.value!==i&&a.push(s.getModification(r.name,"setValue",{value:i})),a.length)for(const e of a)s.applyModification({kind:e.nodeKind,astNodeId:e.targetId},e.modification,e.modificationArgs)}))}renameDemo(e,t){const i=this.options.simpleAstManager.get({filePath:e,parsers:r.simulationAstParsers}),o=(0,a.getDemoNode)(i);if(!o)throw new Error(`Simulation node not found in ${e}`);const n=i.getModification(o,"setName",{name:t});i.applyModification({kind:n.nodeKind,astNodeId:n.targetId},n.modification,n.modificationArgs)}deleteSimulation(e){this.options.projectService.removeEntity(e)}async waitForDependencyResourcesToUpdate(e){const t=this.options.simpleAstManager.get({filePath:e,parsers:r.simulationAstParsers});await new Promise((e=>t.subscribeOnce(e)))}suggestNameAndPathForEmptyBoard(e){return this.suggestNameAndPathForBoardInDirectory(this.options.boardsPath,e)}suggestNameAndPathForCopyOfBoard(e,t,i){return this.suggestNameAndPathForBoardInDirectory(this.fs.dirname(e),i||(0,a.incrementBoardName)(t))}suggestNameAndPathForBoardWithComponent(e,t,i){null!=i||(i=void 0);const s=this.fs,r=this.options.boardsPath,a=(0,n.getComponentName)(e,t),d=(0,o.getPackagePath)(e,this.fs),l=(0,o.getPackagePath)(r,s);if(!d)throw new Error(`Package directory is not found for ${e}`);if(!l)throw new Error(`Package directory is not found for ${r}`);const c=s.join(d,this.fs.relative(l,r),(0,o.toNamingConvention)(a,this.options.fileNamingConvention));return this.suggestNameAndPathForBoardInDirectory(c,null!=i?i:a)}suggestNameAndPathForBoardInDirectory(e,t){e=(0,o.pathToTrueCase)(this.fs,e);let i=t?(0,a.cleanupBoardName)(t):a.defaultBoardName;for(;;){const t=(0,o.toNamingConvention)(i,this.options.fileNamingConvention),n=this.fs.join(e,t+a.boardExtension);if(!this.fs.fileExistsSync(n))return{boardName:i,boardPath:n};i=(0,a.incrementBoardName)(i)}}}},61375:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileNamingConventionFromConfig=t.getBoardsPathFromConfig=void 0;const o=i(3092),n=i(91570),s=i(69144);t.getBoardsPathFromConfig=function(e,t,i){const n=t.isValid()?t.get(i):void 0,s="string"==typeof n&&""!==n;return e.fs.join(e.projectPath,s?n:o.defaultBoardsPath)},t.getFileNamingConventionFromConfig=function(e,t){const i=e.isValid()?e.get(t):void 0;return i&&(0,n.isValidNamingConvention)(i)?i:s.defaultFileNamingConvention}}}]);