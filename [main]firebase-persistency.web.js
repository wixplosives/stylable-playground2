/*! For license information please see [main]firebase-persistency.web.js.LICENSE.txt */
(self.webpackChunk_wixc3_stylable_playground_feature=self.webpackChunk_wixc3_stylable_playground_feature||[]).push([[5585],{49459:(e,t,i)=>{"use strict";i.r(t),i.d(t,{classes:()=>s,cssStates:()=>c,keyframes:()=>r,namespace:()=>n,st:()=>d,stVars:()=>o,style:()=>l,vars:()=>a});const n="o13",s={root:"s65",cloneButton:"s66",newButton:"s67"},r={},o={},a={},c=i.stc.bind(null,n),l=i.sts.bind(null,n),d=l},14480:(e,t,i)=>{"use strict";i.r(t),i.d(t,{classes:()=>s,cssStates:()=>c,keyframes:()=>r,namespace:()=>n,st:()=>d,stVars:()=>o,style:()=>l,vars:()=>a});const n="o17",s={root:"s77"},r={},o={},a={},c=i.stc.bind(null,n),l=i.sts.bind(null,n),d=l},35532:(e,t,i)=>{"use strict";i.r(t),i.d(t,{FirebaseError:()=>n.FirebaseError,SDK_VERSION:()=>n.SDK_VERSION,_DEFAULT_ENTRY_NAME:()=>n._DEFAULT_ENTRY_NAME,_addComponent:()=>n._addComponent,_addOrOverwriteComponent:()=>n._addOrOverwriteComponent,_apps:()=>n._apps,_clearComponents:()=>n._clearComponents,_components:()=>n._components,_getProvider:()=>n._getProvider,_registerComponent:()=>n._registerComponent,_removeServiceInstance:()=>n._removeServiceInstance,deleteApp:()=>n.deleteApp,getApp:()=>n.getApp,getApps:()=>n.getApps,initializeApp:()=>n.initializeApp,onLog:()=>n.onLog,registerVersion:()=>n.registerVersion,setLogLevel:()=>n.setLogLevel});var n=i(37034);(0,n.registerVersion)("firebase","9.8.1","app")},64049:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(93849),s=i(5689);t.default=new n.Feature({id:"shortcuts",dependencies:[],api:{shortcutService:n.Service.withType().defineEntity(s.mainEnv),actionsService:n.Service.withType().defineEntity(s.mainEnv).allowRemoteAccess(),scopesService:n.Service.withType().defineEntity(s.mainEnv).allowRemoteAccess()}})},24577:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(64049);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n(s).default}})},1529:(e,t,i)=>{e.exports=i(24577)},33248:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(93849),s=i(2993);t.default=new n.Feature({id:"analytics",dependencies:[],api:{analyticsConfig:new n.Config({}),analyticsService:n.Service.withType().defineEntity(n.Universal),analyticsSlot:n.Slot.withType().defineEntity(n.Universal),identifySlot:n.Slot.withType().defineEntity(n.Universal),registerSlot:n.Slot.withType().defineEntity(n.Universal)}}).setup(n.Universal,(({analyticsSlot:e,identifySlot:t,registerSlot:i})=>({analyticsService:new s.AnalyticsService(i,t,e)})))},92279:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(33248);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n(s).default}})},2993:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsService=void 0,t.AnalyticsService=class{constructor(e,t,i){this.registerSlot=e,this.identifySlot=t,this.analyticsSlot=i,this.globalAnalyticsAttributes={},this.register=e=>{this.globalAnalyticsAttributes={...this.globalAnalyticsAttributes,...e};for(const t of this.registerSlot)try{t(e)}catch(e){}},this.track=(e,t)=>{for(const i of this.analyticsSlot)try{i(e,t)}catch(e){}},this.identify=e=>{for(const{identifyMethod:t}of this.identifySlot)try{t(e)}catch(e){}},this.resetIdentity=()=>{for(const{resetIdentity:e}of this.identifySlot)if(e)try{e()}catch(e){}}}}},60456:(e,t,i)=>{e.exports=i(92279)},94703:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(5163),s=i(93849),r=i(5689),o=n.__importDefault(i(93208)),a=i(9011);t.default=new s.Feature({id:"firebasePersistency",dependencies:[o.default.asEntity],api:{firebasePersistencyServiceOptions:new s.Config({rootCollectionId:"projects",testingMode:!1}),firebaseConfig:new s.Config(a.firebaseConfig),firebasePersistencyService:s.Service.withType().defineEntity(r.mainEnv),firebaseAuthService:s.Service.withType().defineEntity(r.mainEnv),firebaseCloneHandlers:s.Slot.withType().defineEntity(r.mainEnv)}})},85225:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(5163),s=n.__importDefault(i(87363)),r=i(5689),o=n.__importDefault(i(94703)),a=i(35532),c=i(61008),l=i(75102),d=i(88967),u=i(85470),f=i(71831),h=i(49459),p="localhost";o.default.setup(r.mainEnv,(({onDispose:e,firebaseConfig:t,firebaseCloneHandlers:i,firebasePersistencyServiceOptions:n},{gui:{headerPanelSlot:r}})=>{const o=(0,a.initializeApp)(t),y=(0,c.initializeFirestore)(o,{});n.testingMode&&(0,c.connectFirestoreEmulator)(y,p,8080);const v=(0,l.initializeAuth)(o,{persistence:l.browserLocalPersistence});n.testingMode&&(0,l.connectAuthEmulator)(v,`http://${p}:8081`,{disableWarnings:!0});const E=new u.FirebaseAuthService(v),_=new d.FirebasePersistencyService(E,y,i,n);return r.register({id:"firebaseClone",alignment:"right",Header:function(){return s.default.createElement(f.FirebaseButton,{onClick:async()=>{const e=_.getRootDocumentId();if(e){const t=await _.getDocumentOwnerId(e),i=E.getCurrentUser();if(t&&i){const t=await _.read(e);t&&await _.clone(t)}}},className:h.classes.cloneButton},"Clone")}}),r.register({id:"firebaseCreateNew",alignment:"right",Header:function(){return s.default.createElement(f.FirebaseButton,{onClick:()=>{_.setRootDocumentId("")},className:h.classes.newButton},"New")}}),e((()=>{E.onDispose()})),{firebaseAuthService:E,firebasePersistencyService:_}}))},71831:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseButton=void 0;const n=i(5163).__importStar(i(87363)),s=i(70268),r=i(63372),o=i(14480);t.FirebaseButton=(0,n.memo)((e=>n.default.createElement(s.Button,{...e,className:(0,o.st)(o.classes.root,e.className,r.classes.primaryDarkButton)}))),t.FirebaseButton.displayName="FirebaseButton"},85470:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseAuthService=void 0;const n=i(93849),s=i(75102);t.FirebaseAuthService=class{constructor(e){this.firebaseAuth=e,this.currentUser=null,this.firebaseAuthEvents=new n.EventEmitter,this.unsubscribeFromFirebaseAuth=(0,s.onAuthStateChanged)(this.firebaseAuth,(e=>{this.currentUser=e,this.firebaseAuthEvents.emit("change",this.currentUser),e||this.signInAnonymously().catch(n.reportError)}))}onDispose(){this.unsubscribeFromFirebaseAuth()}subscribeToAuthChange(e){this.firebaseAuthEvents.subscribe("change",e)}unsubscribeToAuthChange(e){this.firebaseAuthEvents.subscribe("change",e)}getAuth(){return this.firebaseAuth}getCurrentUser(){return this.currentUser}async signInAnonymously(){await(0,s.signInAnonymously)(this.firebaseAuth)}async signOut(){return this.firebaseAuth.signOut()}async deleteUser(e){await e.delete()}}},88967:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirebasePersistencyService=t.ReadinessEvent=t.URL_PROJECT_ID_KEY=t.UPGRADE_PENDING_FIELD=t.OWNER_ID_FIELD=void 0;const n=i(93849),s=i(83135),r=i(61008);var o;t.OWNER_ID_FIELD="ownerId",t.UPGRADE_PENDING_FIELD="upgradePending",t.URL_PROJECT_ID_KEY="projectId",function(e){e[e.INVALID_ID_EVENT=0]="INVALID_ID_EVENT",e[e.READY_EVENT=1]="READY_EVENT",e[e.NEW_PROJECT_EVENT=2]="NEW_PROJECT_EVENT"}(o=t.ReadinessEvent||(t.ReadinessEvent={})),t.FirebasePersistencyService=class{constructor(e,t,i,s){this.firebaseAuth=e,this.firestore=t,this.cloneHandlers=i,this.rootCollectionId="projects",this.upgradePending=!1,this.firebasePersistencyEvents=new n.EventEmitter,this.rootCollectionId=(null==s?void 0:s.rootCollectionId)||this.rootCollectionId,this.firebaseAuth.subscribeToAuthChange(this.onAuthChange.bind(this))}async onAuthChange(){const e=new URL(document.location.toString()).searchParams.get(t.URL_PROJECT_ID_KEY);if(e&&!this.rootDocumentId){const i=`${this.rootCollectionId}/${e}`;if(await this.read(i))this.setRootDocumentId(i),this.firebasePersistencyEvents.emit("readiness",o.READY_EVENT);else{this.firebasePersistencyEvents.emit("readiness",o.INVALID_ID_EVENT);const e=new URL(document.location.toString());e.searchParams.delete(t.URL_PROJECT_ID_KEY),s.historyController.push(e.toString()),this.firebasePersistencyEvents.emit("readiness",o.READY_EVENT)}}else e||this.firebasePersistencyEvents.emit("readiness",o.NEW_PROJECT_EVENT)}getRootCollectionId(){return this.rootCollectionId}getRootDocumentId(){return this.rootDocumentId}setRootDocumentId(e){const i=new URL(document.location.toString()),n=i.searchParams.get(t.URL_PROJECT_ID_KEY);if(e)this.rootDocumentId!==e&&(this.rootDocumentId=e,n!==e&&(i.searchParams.set(t.URL_PROJECT_ID_KEY,e.slice(this.rootCollectionId.length+1)),s.historyController.push(i.toString())));else if(this.rootDocumentId=void 0,n){const e=new URL(document.location.toString());e.searchParams.delete(t.URL_PROJECT_ID_KEY),s.historyController.push(e.toString()),document.location.reload()}}async assureRootDocumentExists(){if(this.rootActiveDocumentReady)return this.rootActiveDocumentReady;this.rootActiveDocumentReady=this.rootDocumentId?this.read(this.rootDocumentId):this.create(this.rootCollectionId,{});const e=await this.rootActiveDocumentReady;return e&&this.setRootDocumentId(e.getId()),e}async getDocumentOwnerId(e){var i;const n=await this.read(e);return null===(i=null==n?void 0:n.getValue(t.OWNER_ID_FIELD))||void 0===i?void 0:i.getLatest()}setDocumentOwnerId(e,i){return this.update(e,t.OWNER_ID_FIELD,i)}createCollection(e,t){if(t){const i=(0,r.doc)(this.firestore,t);(0,r.collection)(i,e)}else(0,r.collection)(this.firestore,e)}async create(e,t,i){const n=(0,r.collection)(this.firestore,e),s=this.firebaseAuth.getCurrentUser();if(e===this.rootCollectionId&&s&&(t.ownerId=s.uid),i){const e=(0,r.doc)(this.firestore,n.path,i);return await(0,r.setDoc)(e,t),this.read(e.path)}{const e=await(0,r.addDoc)(n,t);return this.read(e.path)}}async read(e){const t=(0,r.doc)(this.firestore,e),i=await(0,r.getDoc)(t);return i.exists()?this.getActiveDocument(e,i):void 0}async update(e,t,i){const n=(0,r.doc)(this.firestore,e);await(0,r.updateDoc)(n,t,i).catch((e=>{this.firebasePersistencyEvents.emit("permissionMismatch",void 0)}))}async prepareUserOwnershipChange(){var e,i;const n=this.getRootDocumentId();if(n&&(null===(e=this.firebaseAuth.getCurrentUser())||void 0===e?void 0:e.isAnonymous)){const e=await this.getDocumentOwnerId(n);(null===(i=this.firebaseAuth.getCurrentUser())||void 0===i?void 0:i.uid)===e&&(this.upgradePending=!0,await this.update(n,t.UPGRADE_PENDING_FIELD,!0))}}async cancelUserOwnershipChange(){var e;const i=this.getRootDocumentId();if(i&&this.upgradePending){const n=await this.getDocumentOwnerId(i);(null===(e=this.firebaseAuth.getCurrentUser())||void 0===e?void 0:e.uid)===n&&(await this.deleteField(i,t.UPGRADE_PENDING_FIELD),this.upgradePending=!1)}}isUserOwnershipChangePending(){return this.upgradePending}deleteDoc(e){const t=(0,r.doc)(this.firestore,e);return(0,r.deleteDoc)(t)}async deleteField(e,t){const i=(0,r.doc)(this.firestore,e);return(0,r.updateDoc)(i,t,(0,r.deleteField)())}async clone(e){const t=(0,r.doc)(this.firestore,e.getId()),i=await(0,r.getDoc)(t),n=await this.create(this.getDocCollectionId(e),i.data());if(n){const t=n.getId(),i=this.firebaseAuth.getCurrentUser();i&&(this.setRootDocumentId(t),await this.setDocumentOwnerId(t,i.uid));for(const t of this.cloneHandlers)await t(e,n)}return n}getDocCollectionId(e){return(0,r.doc)(this.firestore,e.getId()).parent.path}getActiveDocument(e,t){return{getValue:i=>({persist:t=>this.update(e,i,t),persistField:(t,n)=>this.update(e,`${i}.${n}`,t),async getLatest(){const e=await(0,r.getDoc)(t.ref);if(e.exists())return e.get(i)}}),getId:()=>t.ref.path}}}},9011:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firebaseConfig=void 0,t.firebaseConfig={apiKey:"AIzaSyD-IS7lkB3o9GioLGayvTlOAgl2EFQnKrY",authDomain:"localhost",projectId:"demo-project",storageBucket:"core3-firebase-9b327.appspot.com",messagingSenderId:"491604166384",appId:"1:491604166384:web:fb676c56b4fdb306bd6435"}},13757:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultConfig=void 0;const n=i(5163),s=n.__importDefault(i(1529)),r=n.__importDefault(i(60456)),o=i(93849),a=n.__importStar(i(5689)),c=n.__importDefault(i(31197)),l=n.__importDefault(i(95561));t.defaultConfig={areas:{content:{type:"grid-area",controls:!0,acceptDrag:!1,activeTab:"",semanticId:"content"}},headerHeight:"42px",layout:{rows:"1fr",columns:"1fr",areas:'"content"'},openPanels:[],overlays:[],panelMinWidth:244,panelMaxWidth:500,focusedTab:{id:"",area:"content"},resizers:!1},t.default=new o.Feature({id:"gui",dependencies:[o.COM.asEntity,a.default.asEntity,l.default.asEntity,s.default.asEntity,r.default.asEntity,c.default.asEntity],api:{applicationLogoService:o.Service.withType().defineEntity(a.mainEnv).allowRemoteAccess((0,o.declareComEmitter)("onApplicationLogoClick","offApplicationLogoClick")),headerPanelSlot:o.Slot.withType().defineEntity(a.mainEnv),headerPanelConfig:new o.Config({}),documentTitleSlot:o.Slot.withType().defineEntity(a.mainEnv),panelFactory:o.Slot.withType().defineEntity(a.mainEnv),overlayPanelFactory:o.Slot.withType().defineEntity(a.mainEnv),homeScreenPanelFactory:o.Slot.withType().defineEntity(a.mainEnv),sideBarPanelFactory:o.Slot.withType().defineEntity(a.mainEnv),sideBarConfig:new o.Config({isOpen:!0}),contentConfig:new o.Config(t.defaultConfig),panelStore:o.Service.withType().defineEntity(a.mainEnv),globalWindowEventEmitter:o.Service.withType().defineEntity(a.mainEnv),dragManager:o.Service.withType().defineEntity(a.mainEnv),errorBoundarySlot:o.Slot.withType().defineEntity(a.mainEnv),contextSlot:o.Slot.withType().defineEntity(a.mainEnv),navigationService:o.Service.withType().defineEntity(a.mainEnv).allowRemoteAccess()}})},23719:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n=i(5163);var s=i(13757);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.__importDefault(s).default}}),n.__exportStar(i(13757),t)},93208:(e,t,i)=>{e.exports=i(23719)},83135:(e,t,i)=>{e.exports=i(77467)},31197:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n=i(5163);n.__exportStar(i(36041),t);var s=i(36041);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.__importDefault(s).default}})},36041:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defineGlobalStateResource=void 0;const n=i(93849),s=i(5689);t.defineGlobalStateResource=()=>n.Service.withType().defineEntity(s.mainEnv);const r=new n.Feature({id:"reactResources",api:{createStateResource:n.Service.withType().defineEntity(s.mainEnv)},dependencies:[]});t.default=r},17362:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n=i(5163);n.__exportStar(i(44069),t);var s=i(44069);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.__importDefault(s).default}})},44069:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(93849),s=i(5689);t.default=new n.Feature({id:"storage",dependencies:[],api:{localStorageService:n.Service.withType().defineEntity(s.mainEnv),sessionStorageService:n.Service.withType().defineEntity(s.mainEnv)}})},95561:(e,t,i)=>{e.exports=i(17362)}}]);